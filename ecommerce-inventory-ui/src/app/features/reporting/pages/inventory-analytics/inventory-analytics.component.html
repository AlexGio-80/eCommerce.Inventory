<div class="inventory-analytics">
    <h2>Analisi Inventario</h2>

    <!-- KPI Metrics -->
    <div class="metrics" *ngIf="inventoryValue">
        <div class="metric-item">
            <h3>Valore Totale</h3>
            <p>{{ inventoryValue.totalValue | currency:'EUR':'symbol':'1.2-2' }}</p>
        </div>
        <div class="metric-item">
            <h3>Totale Articoli</h3>
            <p>{{ inventoryValue.totalItems }}</p>
        </div>
    </div>

    <!-- Distribution Chart -->
    <div class="chart-container" *ngIf="distributionValues.length > 0">
        <h3>Distribuzione Valore per Gioco</h3>
        <canvas baseChart
            [data]="{ datasets: [{ data: distributionValues, label: 'Valore' }], labels: distributionLabels }"
            [options]="chartOptions" [legend]="true" chartType="pie">
        </canvas>
    </div>

    <!-- Slow Movers Grid -->
    <h3>Articoli a Bassa Rotazione (>90 giorni)</h3>
    <ag-grid-angular class="ag-theme-alpine" style="width: 100%; height: 300px; margin-bottom: 24px;" [rowData]="slowMovers"
        [columnDefs]="slowMoversColumnDefs">
    </ag-grid-angular>

    <!-- Top Expansions Grid -->
    <div class="top-expansions-section" *ngIf="topExpansionsByValue.length > 0">
        <h3>Espansioni pi√π Convenienti (Valore Medio Carta)</h3>
        <p style="font-size: 14px; color: #666; margin-bottom: 8px;">
            Basato sul prezzo minimo di vendita di tutte le carte dell'espansione.
        </p>
        <ag-grid-angular class="ag-theme-alpine" style="width: 100%; height: 400px;" [rowData]="topExpansionsByValue"
            [columnDefs]="topExpansionsColumnDefs">
        </ag-grid-angular>
    </div>
</div>